<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project SYSTEM "../dtd/Project.dtd">

<project default="test">

    <target name="test">

        <webtest name="check page Tree1 in Wiki">
            <invoke url="${wgScript}/Tree1" description="Go to page Tree1"/>
            <verifyText
                description="small headline above the tree"
                text="Testpage for Webtest of Tree1" />
            <storeRegEx 
                description="Get id of tree"
                text="new dTree\('tv([a-f0-9]{13})',"
                group="1"
                property="treeId" />
            <verifyXPath
                description="Check id in div element"
                xpath="//div[@class='Treeview']/@id"
                text="#{treeId}" />
            <verifyText
                description="Check for addSmwData"
                text="tv#{treeId}.addSmwData(0, 'Subsection of',null, null, null, null, null, null, null, 1);"
            />
            <verifyText
                description="Check node exists: Contents"
                text="tv#{treeId}.add(1,0,'&lt;a href=\&quot;${wgScript}/Help:Contents\&quot; title=\&quot;Help:Contents\&quot;&gt;Contents&lt;/a&gt;');"
            />
            <verifyText
                description="Check command exists: setLeaf(2)"
                text="tv#{treeId}.setLeaf(2);"
            />
            <verifyText
                description="Check node exists: Märchen"
                text="tv#{treeId}.add(7,6,'&lt;a href=\&quot;${wgScript}/M%C3%A4rchen\&quot; title=\&quot;Märchen\&quot;&gt;Märchen&lt;/a&gt;');"
            />
            <verifyText
                description="Check node exists: Der Wolf und die 7 Geißlein"
                text="tv#{treeId}.add(11,9,'&lt;a href=\&quot;${wgScript}/Der_Wolf_und_die_7_Gei%C3%9Flein\&quot; title=\&quot;Der Wolf und die 7 Geißlein\&quot;&gt;Der Wolf und die 7 Geißlein&lt;/a&gt;');"
            />
            <verifyText
                description="Check that Der Wolf und die 7 Geißlein is a leaf"
                text="tv#{treeId}.setLeaf(11);"
            />
            <verifyText
                description="Check that die 3 Schlangenblätter is a leaf as well"
                text="tv#{treeId}.setLeaf(12);"
            />
            <verifyText
                description="Check node exists: Wilhelm Hauff"
                text="tv#{treeId}.add(18,7,'&lt;a href=\&quot;${wgScript}/Wilhelm_Hauff\&quot; title=\&quot;Wilhelm Hauff\&quot;&gt;Wilhelm Hauff&lt;/a&gt;');"
            />

            <verifyText
                description="Check command exists: openNode"
                text="tv#{treeId}.openToName('Frau_Holle');"
            />
            <not description="Check that Wilhelm Hauff is no leaf">
                <verifyText
                    description="Check command exists: setLeaf(18)"
                    text="tv#{treeId}.setLeaf(18);"
                />
            </not>
        	
        	<verifyXPath
        	   description="Node icon at die 3 Schlangenblätter?"
        	   xpath="//img[@id='itv#{treeId}12']/@src"
        	   text="page.gif$"
        	   regex="true"
        	/>
            <verifyXPath
               description="Folder icon at Frau Holle?"
               xpath="//img[@id='itv#{treeId}13']/@src"
               text="folder.gif$"
               regex="true"
            />

            <verifyXPath
               description="Children of Help:Content are hidden"
               xpath="//div[@id='dtv#{treeId}1']/@style"
               text="display:none;"
            />

        	<verifyXPath
               description="and must be 4"
               xpath="count(//div[@id='dtv#{treeId}1']/div)"
               text="4"
            />
        	
            <clickElement
        	   description="Click to open node Help:Content"
        	   xpath="//a[@href='javascript: tv#{treeId}.o(1);']"
               save="contentOpen18"
        	/>

   	        <verifyXPath
               description="and nodes are beeing displayed now"
               xpath="//div[@id='dtv#{treeId}1']/@style"
               text="display: block;"
            />

        	<verifyXPath
        	   description="Wilhelm Hauff has no children"
        	   xpath="count(//div[@id='dtv#{treeId}18'])"
        	   text="0"
            />

        </webtest>

    </target>
</project>
